---
# Playbook: setup.yml
# Simplified setup for HSI Compression Framework
# Assumes CUDA is already installed on the remote machine
# Usage: ansible-playbook setup.yml -i inventory.ini -l gpu_servers

- name: Setup HSI Compression Framework on Remote GPU Machine
  hosts: "{{ target_hosts | default('gpu_servers') }}"
  gather_facts: yes

  tasks:
    - name: Display setup information
      debug:
        msg: |
          ============================================
          HSI Compression Framework Setup (Simplified)
          ============================================
          
          Target hosts: {{ inventory_hostname }}
          OS: {{ ansible_distribution }} {{ ansible_distribution_version }}
          
          Note: This setup assumes CUDA is already installed.
          ============================================

    - name: Include consolidated environment setup role
      include_role:
        name: environment_setup

    - name: Setup completed
      debug:
        msg: |
          ============================================
          Setup Completed Successfully!
          ============================================
          
          Virtual environment: {{ venv_dir }}
          Activate with: source {{ venv_dir }}/bin/activate
          
          To verify installation:
            source {{ venv_dir }}/bin/activate
            python -c "from mamba_ssm import Mamba; print('Success')"
          
          Next steps:
          
          1. Pull dataset:
             ansible-playbook dataset.yml -i inventory.ini -l {{ inventory_hostname }}
          
          2. Run training:
             source {{ venv_dir }}/bin/activate
             python train.py --config hsi_compression/configs/models/tcn_lossless.yaml
          
          3. Evaluate model:
             ansible-playbook evaluate.yml -i inventory.ini -l {{ inventory_hostname }}
